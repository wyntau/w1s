$(function(){
$(".paging").show();
	$(".paging a:first").addClass("active");	
	var imageWidth = "800";
	var imageSum = $(".image_reel img").size();
	var imageReelWidth = imageWidth * imageSum;
	$(".image_reel").css({'width' : imageReelWidth});	
	rotate = function(){	
		var triggerID = $active.attr("title") - 1;
		var image_reelPosition = triggerID * imageWidth;
		$(".paging a").removeClass('active');
		$active.addClass('active');
		$(".image_reel").animate({ 
			left: -image_reelPosition
		}, 800);		
	}; 
	rotateSwitch = function(){		
		play = setInterval(function(){
			$active = $('.paging a.active').next();
			if ( $active.length === 0) {
				$active = $('.paging a:first');
			}
			rotate();
		}, 5000);
	};	
	rotateSwitch();
	$(".image_reel li").hover(function() {
		clearInterval(play);
	}, function() {
		rotateSwitch();
	});		
	$(".paging a").click(function() {	
		$active = $(this);
		clearInterval(play);
		rotate();
		rotateSwitch();
		return false;
	});	
$body=(window.opera)?(document.compatMode=="CSS1Compat"?$('html'):$('body')):$('html,body');
$('#shang').mouseover(function(){
		up();
	}).mouseout(function(){
		clearTimeout(fq);
	}).click(function(){
		$body.animate({scrollTop:0},400);
});
$('#xia').mouseover(function(){
		dn();
	}).mouseout(function(){
		clearTimeout(fq);
	}).click(function(){
		$body.animate({scrollTop:$(document).height()},400);
});
$('#comt').click(function(){
	$body.animate({scrollTop:$('#comments').offset().top},400);
});
$('#gotop').click(function(){
    $body.animate({
            scrollTop: $("#wrap").offset().top
        },
 600);
 return false;
    });
function img() {
$('#container img').hover(
function() {$(this).fadeTo("fast", 0.7);},
function() {$(this).fadeTo("fast", 1);
});
} 
img();
$('a,input[type="submit"],button[type="button"],object').bind('focus',function(){if(this.blur){ this.blur();}});
$('#s,#author,#email,#url').mouseover(function(){
	$(this).focus();
});
$('#container').animate({ opacity: '0.87' }, 2000);
$('#toolBar').slideUp(200);
$('#comment').focus(function(){
    	$('#toolBar').slideDown(500);
    });
function getParamsOfShareWindow(width, height) {
		return ['toolbar=0,status=0,resizable=1,width=' + width + ',height=' + height + ',left=', (screen.width - width) / 2, ',top=', (screen.height - height) / 2].join('')
	}
	function bindShareList() {
		var link = encodeURIComponent(document.location);
		var title = encodeURIComponent(document.title.substring(0, 76));
		var source = encodeURIComponent('');
		var windowName = 'share';
		var site =base;
		jQuery('#facebook-share').click(function() {
			var url = 'http://facebook.com/share.php?u=' + link + '&t=' + title;
			var params = getParamsOfShareWindow(626, 436);
			window.open(url, windowName, params)
		});
		jQuery('#twitter-share').click(function() {
			var url = 'http://twitter.com/share?url=' + link + '&text=' + title;
			var params = getParamsOfShareWindow(500, 375);
			window.open(url, windowName, params)
		});
		jQuery('#delicious-share').click(function() {
			var url = 'http://delicious.com/post?url=' + link + '&title=' + title;
			var params = getParamsOfShareWindow(550, 550);
			window.open(url, windowName, params)
		});
		jQuery('#kaixin001-share').click(function() {
			var url = 'http://www.kaixin001.com/repaste/share.php?rurl=' + link + '&rcontent=' + link + '&rtitle=' + title;
			var params = getParamsOfShareWindow(540, 342);
			window.open(url, windowName, params)
		});
		jQuery('#renren-share').click(function() {
			var url = 'http://share.renren.com/share/buttonshare?link=' + link + '&title=' + title;
			var params = getParamsOfShareWindow(626, 436);
			window.open(url, windowName, params)
		});
		jQuery('#douban-share').click(function() {
			var url = 'http://www.douban.com/recommend/?url=' + link + '&title=' + title;
			var params = getParamsOfShareWindow(450, 350);
			window.open(url, windowName, params)
		});
		jQuery('#sina-share').click(function() {
			var url = 'http://v.t.sina.com.cn/share/share.php?url=' + link + '&title=' + title;
			var params = getParamsOfShareWindow(607, 523);
			window.open(url, windowName, params)
		});
		jQuery('#netease-share').click(function() {
			var url = 'http://t.163.com/article/user/checkLogin.do?link=' + link + 'source=' + source + '&info=' + title + ' ' + link;
			var params = getParamsOfShareWindow(642, 468);
			window.open(url, windowName, params)
		});
		jQuery('#tencent-share').click(function() {
			var url = 'http://v.t.qq.com/share/share.php?title=' + title + '&url=' + link + '&site=' + site;
			var params = getParamsOfShareWindow(634, 668);
			window.open(url, windowName, params)
		})
	}
bindShareList();
function h(y) {
		var x = document.getElementById("comment");
		if (y) {
			if (document.selection) {
				sel = document.selection.createRange();
				sel.text = y
			} else {
				if (x.selectionStart || x.selectionStart == "0") {
					var w = x.selectionStart;
					var v = x.selectionEnd;
					var z = w;
					x.value = x.value.substring(0, w) + y + x.value.substring(v, x.value.length);
					z += y.length;
					x.selectionStart = z;
					x.selectionEnd = z
				} else {
					x.value += y
				}
			}
		}
	}
function smile_show() {
		var x = $("#smelislist");
		var w = $("#smiliebtn");
		var y = $("#smelislist a");	
			x.hide(200)
		w.click(function() {
			x.toggle(200);
			return false
		});
		y.click(function() {
			var z = $(this).attr("title");
			$("#comment").focus();
			h(z);
			w.click();
			return false
		})
	}
	smile_show();
function fanye (){
$("#pagenavi a").click(function() {
			var z = $(this).attr("href");
			$.ajax({
			url: z,
			type:"POST",
			data:"action=ajax_post",
			beforeSend:function(){
			$("#pagenavi").html('<p class="ajaxloading">载入中</p>');
			},
			success: function (data){
			$("#middle").slideUp(300).html(data).slideDown(500,function() {
					$body.animate({
						scrollTop: $(this).offset().top - 100
					},
					500)
				});
			fanye();
			img();
			}			
			});
			return false;
		});
}
fanye();
$(function() {
	function addEditor(a, b, c) {
		if (document.selection) {
			a.focus();
			sel = document.selection.createRange();
			c ? sel.text = b + sel.text + c: sel.text = b;
			a.focus()
		} else if (a.selectionStart || a.selectionStart == '0') {
			var d = a.selectionStart;
			var e = a.selectionEnd;
			var f = e;
			c ? a.value = a.value.substring(0, d) + b + a.value.substring(d, e) + c + a.value.substring(e, a.value.length) : a.value = a.value.substring(0, d) + b + a.value.substring(e, a.value.length);
			c ? f += b.length + c.length: f += b.length - e + d;
			if (d == e && c) f -= c.length;
			a.focus();
			a.selectionStart = f;
			a.selectionEnd = f
		} else {
			a.value += b + c;
			a.focus()
		}
	}
	var g = document.getElementById('comment') || 0;
	var h = {
		strong: function() {
			addEditor(g, '<strong>', '</strong>')
		},
		em: function() {
			addEditor(g, '<em>', '</em>')
		},
		del: function() {
			addEditor(g, '<del>', '</del>')
		},
		underline: function() {
			addEditor(g, '<u>', '</u>')
		},
		quote: function() {
			addEditor(g, '<blockquote>', '</blockquote>')
		},
		ahref: function() {
			var a = prompt('Enter the URL', 'http://');
			if (a) {
				addEditor(g, '<a target="_blank" href="' + a + '" rel="external">', '</a>')
			}
		},
		syntax: function() {
			var a = prompt('Enter the Language or Just press OK', 'unknown');
			if (a) {
				addEditor(g, '<pre lang="' + a + '">', '</pre>')
			}
		},
		code: function() {
			addEditor(g, '<code>', '</code>')
		},
		clear: function() {
		myField = g;
		if (document.selection) {
			myField.focus();
			sel = document.selection.createRange();
			sel.text = sel.text.replace(/(?:<|\[)[^>]*?(?:>|\])/gi, "");
			myField.focus()
		} else {
			if (myField.selectionStart || myField.selectionStart == "0") {
				var b = myField.selectionStart;
				var a = myField.selectionEnd;
				var c = b;
				myField.value = myField.value.substring(0, b) + myField.value.substring(b, a).replace(/(?:<|\[)[^>]*?(?:>|\])/gi, "") + myField.value.substring(a, myField.value.length);
				myField.focus();
				myField.selectionStart = c;
				myField.selectionEnd = c
			} else {
				myField.value = myField.value.replace(/(?:<|\[)[^>]*?(?:>|\])/gi, "");
				myField.focus()
			}
		}
	},
		empty: function() {
		g.value = "";
		g.focus()
	},
		countWords: function() {
		var a = g.value.replace(/(?:<|\[)[^>]*?(?:>|\])/gi, "").replace(/\t|\n|\r\n/gi, "");
		alert("您输入了 " + a.length + " 字!");
		g.focus()
	}
	};
var mycode = document.getElementById("commentform") || 0;
mycode.onsubmit = function() {
	var b = document.getElementById("comment");
	var c = b.value;
	var d = c.indexOf("<code>");
	var a = c.indexOf("</code>");
	if (d > -1 && a > -1 && d < a) {
		b.value = ""
	} else {
		return
	}
	while (a != -1) {
		b.value += c.substring(0, d + 6) + c.substring(d + 6, a).replace(/<(?=[^>]*?>)/gi, "&lt;").replace(/>/gi, "&gt;");
		c = c.substring(a + 7, c.length);
		d = c.indexOf("<code>") == -1 ? -6: c.indexOf("<code>");
		a = c.indexOf("</code>");
		if (a == -1) {
			b.value += "</code>" + c
		} else {
			if (d == -6) {
				b.value += "&lt;/code&gt;"
			} else {
				b.value += "</code>"
			}
		}
	}
};
	window['SIMPALED'] = {};
	window['SIMPALED']['Editor'] = h
});
});
function up(){
   $wd = $(window);
   $wd.scrollTop($wd.scrollTop() - 1);
   fq = setTimeout("up()", 50);
}
function dn(){
   $wd = $(window);
   $wd.scrollTop($wd.scrollTop() + 1);
   fq = setTimeout("dn()", 50);
}
